library(stats)
library(forecast)
library(stringr)
library(dplyr)
library(tseries)

source('./season/models.R')

data = read.csv('./data/func-10min-november.csv')

# Replacing NA values & dates
data$incoming_intensity[is.na(data$incoming_intensity)] = 0
data$period_date = str_replace_all(data$period_date, "T", " ")
data.workdays = dplyr::filter(data, day_of_week %in% 1:5)


Box.test(data.workdays$incoming_intensity, lag = 144, type="Ljung-Box")
adf.test(data.workdays$incoming_intensity)
kpss.test(data.workdays$incoming_intensity, null="Trend")


# ARIMA
?auto.arima
model.arima = run.model(type = 'ARIMA', data = data.workdays$incoming_intensity, freq = 144, sample_size = 1000)
plot.ts(c(data.workdays$incoming_intensity, model.arima$pred$mean))
model.arima$accuracy

# HW
?HoltWinters
model.hw = run.model(type = 'HW', data = data.workdays$incoming_intensity, freq = 144, sample_size = 1000)
plot.ts(c(data.workdays$incoming_intensity, model.hw$pred$mean))
model.hw$accuracy

# TBATS
?tbats
model.tbats = run.model(type = 'TBATS', data = data.workdays$incoming_intensity, freq = 144, sample_size = 1000)
plot.ts(c(data.workdays$incoming_intensity, model.tbats$pred$mean))
model.tbats$accuracy
model.tbats

?accuracy
